{% for item in items %}
<div class="wrapper-background mb-3">
    <div class="p-4">
        <!-- En-tête de la carte -->
        <div class="flex items-center justify-between mb-3">
            <div class="flex items-center space-x-3">
                <img src="{{ item.item.imgUrl ?: '/images/items/default.png' }}" alt="{{ item.item.name }}" class="w-10 h-10 rounded">
                <div>
                    <h3 class="text-white font-medium">{{ item.item.name }}</h3>
                    <p class="text-gray-400 text-sm">{{ item.lotSize }}x {{ item.item.itemType ? item.item.itemType.value : 'N/A' }}</p>
                </div>
            </div>
            <span class="px-2 py-1 rounded-full text-xs {{ item.status.value == 'available' ? 'bg-green-800 text-green-200' : 'bg-gray-800 text-gray-200' }}">
                {{ item.status.value == 'available' ? 'Disponible' : item.status.value|title }}
            </span>
        </div>

        <!-- Informations financières -->
        <div class="grid grid-cols-2 gap-4 mb-4">
            <div>
                <p class="text-gray-400 text-xs mb-1">Prix d'achat</p>
                <p class="text-red-400 font-medium">
                    {{ item.buyPricePerLot|format_kamas }}
                </p>
            </div>
            <div>
                <p class="text-gray-400 text-xs mb-1">Prix de vente</p>
                <p class="text-green-400 font-medium">
                    {{ item.sellPricePerLot|format_kamas }}
                </p>
            </div>
        </div>

        <!-- Profit -->
        {% set profit = (item.sellPricePerLot ?: 0) - (item.buyPricePerLot ?: 0) %}
        {% set profitPerUnit = item.lotSize > 0 ? profit / item.lotSize : 0 %}
        <div class="mb-4">
            <p class="text-gray-400 text-xs mb-1">Profit</p>
            <div class="flex justify-between items-center">
                <p class="{{ profit >= 0 ? 'text-green-400' : 'text-red-400' }} font-medium">
                    {{ profit|format_kamas }}
                </p>
                <p class="text-gray-400 text-xs">
                    Par unité: {{ profitPerUnit|format_kamas }}
                </p>
            </div>
        </div>

        <!-- Actions -->
        <div class="flex gap-2 pt-3 border-t border-gray-600">
            <a href="{{ path('app_lot_edit', {id: item.id}) }}"
               class="text-blue-400 hover:text-blue-300 text-sm px-3 py-2 border border-blue-400 rounded flex-1 text-center">
                Modifier
            </a>
            <a href="{{ path('app_lot_sell', {id: item.id}) }}"
               class="text-green-400 hover:text-green-300 text-sm px-3 py-2 border border-green-400 rounded flex-1 text-center">
                Vendre
            </a>
            <form method="POST" action="{{ path('app_lot_delete', {id: item.id}) }}" style="display:inline;" onsubmit="return confirm('Supprimer ce lot ?')">
                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ item.id) }}">
                <button type="submit" class="text-red-400 hover:text-red-300 text-sm px-3 py-2 border border-red-400 rounded">
                    Supprimer
                </button>
            </form>
        </div>
    </div>
</div>
{% endfor %}